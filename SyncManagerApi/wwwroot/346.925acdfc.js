(globalThis.webpackChunkreact_simple=globalThis.webpackChunkreact_simple||[]).push([[346],{96922:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Z}),a(25433);var n=a(6333),r=a(77226),i=a(18336);function o(e){window!=window.parent&&(window.parent.postMessage(e,"*"),console.log("send msg",e))}var l=a(42930);const c=a.p+"83c12eede95f860c27cd0d5c9d38ce85.png";function s(){return i.createElement("div",{className:l.iv`
        width: 100%;
        height: 4rem;
        display: flex;
        border-bottom: 1px #ddd solid;
      `},i.createElement("img",{src:c,className:l.iv`
          margin: 3px 1rem;
        `}))}a(58213);var d=a(76473),m=(a(9484),a(91692)),u=(a(27892),a(39288)),p=(a(49195),a(88485)),g=(a(26318),a(19057)),f=a(20742),h=a(26205),y=a(35050),w=a.n(y);const v=new class{async queryHistoryList(e,t,a=1,n=15){if(console.log(window.syncManagerConfig),!window.syncManagerConfig||!window.syncManagerConfig.dataServerUrl)throw new Error("No remote server API config");return w().get(`${window.syncManagerConfig?.dataServerUrl}/api/UrlHistory/Query`,{params:{pageIndex:a,pageSize:n,keyword:e,dateFrom:t?.dateFrom?.toISOString(),dateTo:t?.dateTo?.toISOString(),equipments:t?.equipmentName}})}};var E=a(62927),C=a.n(E),b=a(45872),S=a.n(b);const _=(0,r.ZP)(g.default).withConfig({displayName:"SearchListGroup__StyledList",componentId:"sc-i6b8ht-0"})(["margin:0.5rem 0rem;.ant-list-item{padding:8px 8px !important;&:hover{background-color:#e6e5e5;border-radius:3px;}}"]);function x(e){return i.createElement(g.default.Item,{onClick:()=>{e.onClick(e.data)},title:`${e.data.equipmentName} ${C()(e.data.timestamp).format("YYYY-MM-DD HH:mm ")} \n ${e.data.url}`},i.createElement(D,null,i.createElement(q,{src:e.data.faviconUrl,$_css:e.data.faviconUrl?0:"50%"}),i.createElement("div",{style:{flex:1,width:"calc(100% - 1.7rem)"}},i.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"}},i.createElement("span",{style:{flex:1,fontSize:"90%"}},e.data.title)))))}function T(e){return i.createElement(i.Fragment,null,i.createElement(Y,{plain:!0,key:e.groupTitle},e.groupTitle),e.items.map((t=>i.createElement(x,{data:t,onClick:e.onClick,onClickEquipmentTag:e.onClickEquipmentTag}))))}function M(e){return e.data.equipmentName||e.data.dateTo?i.createElement(L,null,i.createElement("span",{style:{marginRight:".5rem"}},"Filter:"),e.data.equipmentName&&i.createElement(p.default,{closable:!0,onClose:()=>{e.onChange({...e.data,equipmentName:void 0})}},e.data.equipmentName),e.data.dateFrom&&i.createElement(p.default,{closable:!0,onClose:()=>{e.onChange({...e.data,dateFrom:void 0,dateTo:void 0})}},e.data.dateFrom.format("YY/MM/DD")+"-"+e.data.dateTo.format("YY/MM/DD"))):null}let N=0;function k(){const[e,t]=(0,i.useState)([]),[a,r]=(0,i.useState)(!1),[l,c]=(0,i.useState)({});let[s,d]=(0,i.useState)(""),[p,g]=(0,i.useState)({total:0,current:1});function y(e){c({equipmentName:e.equipmentName})}function w(e){o({type:"OpenNewTab",url:e.url})}return(0,i.useEffect)((()=>{r(!0),async function(){v.queryHistoryList().then((e=>{g({total:e.data.total,current:e.data.current}),t(e.data?.data),r(!1)})).catch((e=>{console.error(e),r(!1)}))}()}),[]),i.createElement(i.Fragment,null,i.createElement(I,null,i.createElement(u.Z,{size:"large",placeholder:"搜索历史访问记录",allowClear:!0,value:s,prefix:i.createElement(f.Z,null),onChange:e=>{let a=e.target.value;d(a),function(e){r(!0),t([]),N&&(clearTimeout(N),N=0),N=setTimeout((function(){v.queryHistoryList(e,l,1,15).then((e=>{g({total:e.data.total,current:e.data.current}),t(e.data?.data),r(!1)})).catch((e=>{console.error(e),r(!1)}))}),1e3)}(a)}})),i.createElement(M,{data:l,onChange:c}),i.createElement("div",{id:"scrollableDiv",style:{marginTop:".5rem",maxHeight:"450px",minHeight:"300px",overflow:"auto",padding:"0 4px",borderTop:"1px solid rgba(140, 140, 140, 0.35)",borderBottom:"1px solid rgba(140, 140, 140, 0.35)"}},i.createElement(h.Z,{dataLength:e.length,next:function(){a||(r(!0),v.queryHistoryList(s,l,p.current+1,15).then((a=>{g({total:a.data.total,current:a.data.current}),t([...e,...a.data?.data]),r(!1)})).catch((e=>{console.error(e),r(!1)})))},hasMore:e.length<p.total,loader:!a&&i.createElement("div",{style:{display:"flex",justifyContent:"center",alignContent:"center"}},i.createElement(n.default,null)),endMessage:!a&&i.createElement(m.Z,{plain:!0},"已经到底啦 🤐"),scrollableTarget:"scrollableDiv"},i.createElement(_,{loading:a,itemLayout:"horizontal",size:"small",dataSource:function(e){return S()(e).groupBy((e=>C()(e.timestamp).format("YYYY-MM-DD A"))).map((e=>({groupTitle:C()(e[0].timestamp).format("YYYY-MM-DD A"),items:e}))).value()}(e),renderItem:e=>i.createElement(T,{key:e.groupTitle,items:e.items,groupTitle:e.groupTitle,onClick:w,onClickEquipmentTag:y})}))))}var D=(0,r.ZP)("div").withConfig({displayName:"SearchListGroup___StyledDiv",componentId:"sc-i6b8ht-1"})(["display:flex;justify-content:space-between;width:100%;align-items:center;"]),q=(0,r.ZP)(d.ZP).withConfig({displayName:"SearchListGroup___StyledAvatar",componentId:"sc-i6b8ht-2"})(["min-width:1rem;min-height:1rem !important;width:1rem !important;height:1rem !important;margin-right:0.5rem !important;border-radius:",";"],(e=>e.$_css)),Y=(0,r.ZP)(m.Z).withConfig({displayName:"SearchListGroup___StyledDivider",componentId:"sc-i6b8ht-3"})(["margin:0 !important;"]),L=(0,r.ZP)("div").withConfig({displayName:"SearchListGroup___StyledDiv2",componentId:"sc-i6b8ht-4"})(["margin:0px 1rem 5px 1rem;"]),I=(0,r.ZP)("div").withConfig({displayName:"SearchListGroup___StyledDiv3",componentId:"sc-i6b8ht-5"})(["margin:1rem 1rem 0.5rem 1rem;display:flex;align-items:center;justify-content:space-around;.ant-input-affix-wrapper{border-radius:2rem !important;border-radius:2rem !important;}"]);function Z(){const[e,t]=(0,i.useState)(!0),a=(0,i.useMemo)((()=>new ResizeObserver((e=>{e[0]?.contentRect&&o({type:"ResizeWindow",height:e[0].contentRect.height,width:e[0].contentRect.width})}))),[]),r=(0,i.useCallback)((e=>{console.log(e),null!=e&&a.observe(e)}),[]);return(0,i.useRef)(null),console.log(),(0,i.useEffect)((()=>{var e;window!=window.top?("SetConfig",e=e=>{window.syncManagerConfig=e.syncManagerConfig,t(!1)},window.addEventListener("message",(t=>{t.data&&"SetConfig"==t.data.type&&e(t.data)}),!1),o({type:"GetConfig"})):(window.syncManagerConfig={dataServerUrl:"http://localhost:5266"},t(!1))}),[]),i.createElement(z,{ref:r},i.createElement("div",{className:"bar"},i.createElement(s,null)),e?i.createElement(n.default,{tip:"正在初始化"}):i.createElement(k,null))}var z=(0,r.ZP)("section").withConfig({displayName:"Popup___StyledSection",componentId:"sc-o6znvb-0"})(["width:30rem;"])},84351:(e,t,a)=>{var n={"./en-gb":71344,"./en-gb.js":71344,"./zh-cn":53052,"./zh-cn.js":53052};function r(e){var t=i(e);return a(t)}function i(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=i,e.exports=r,r.id=84351}}]);